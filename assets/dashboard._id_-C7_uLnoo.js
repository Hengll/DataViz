import{_ as P,S as F,R as O,a as T,u as E,Z as H,r as p,d as M,$ as X,e as Y,o as m,n as y,w as t,f as w,g as s,aj as Z,X as q,k as o,t as r,j as l,U as V,V as D,a0 as S,l as G,F as J,p as C,Y as K}from"./index-B1YMRt2e.js";import{D as Q}from"./DraggableResizable-XNMERF4F.js";import{b as z}from"./route-block-B_A1xBdJ.js";import{a as d,V as U}from"./VRow-C5nTvUYu.js";import{V as ee}from"./VDivider-Cc1XVpnF.js";import{V as ae}from"./VContainer-DJratR_J.js";import"./VHover-MBqlIQs2.js";const se={key:0,class:"loading-mask"},oe={class:"me-8"},te={class:"mx-1"},re={class:"outer-area"},$={__name:"dashboard.[id]",setup(le){const{api:N,apiAuth:A}=K(),f=F(),g=O(),v=T(),u=E(),e=H(),k=p(!0);e.clearDashboard(),(async()=>{try{await e.getDashboardWithPublicAPI(f.params.id),await N.patch(`/dashboard/view/${f.params.id}`),document.title=e.dashboard.dashboardName+" - DataViz",k.value=!1}catch(a){console.log(a),g.push("/")}})();const B=M(()=>e.dashboard.likeUsers?{color:e.dashboard.likeUsers.includes(u.id)?v.global.current.value.colors.primary:v.global.current.value.colors.onSurface}:{}),R=async()=>{try{if(e.dashboard.likeUsers)if(await A.patch(`/dashboard/like/${f.params.id}`),!e.dashboard.likeUsers.includes(u.id))e.dashboard.likeUsers.push(u.id),e.dashboard.like++;else{const a=e.dashboard.likeUsers.indexOf(u.id);e.dashboard.likeUsers.splice(a,1),e.dashboard.like--}}catch(a){console.log(a),g.push("/login")}},n=p(null),b=p(0),_=p(0),I=new ResizeObserver(a=>{for(const c of a)b.value=c.contentBoxSize[0].inlineSize,_.value=c.contentBoxSize[0].blockSize}),W=()=>{const a=n.value.offsetWidth+200;a>2560||(n.value.style.width=a+"px")},j=()=>{const a=n.value.offsetWidth-200;a<200||(n.value.style.width=a+"px")};X(()=>{I.observe(n.value,{box:"content-box"})});const x={x:96,y:54};return(a,c)=>{const L=Y("router-link");return m(),y(ae,null,{default:t(()=>[k.value?(m(),w("div",se,[s(Z,{color:"primary",indeterminate:""})])):q("",!0),s(U,null,{default:t(()=>[s(d,{cols:"12",class:"d-flex"},{default:t(()=>{var i;return[o("p",oe,r(l(e).dashboard.dashboardName),1),o("p",null,[V(r(a.$t("explore.author"))+" : ",1),o("span",null,[s(L,{to:"/author/"+((i=l(e).dashboard.user)==null?void 0:i._id)},{default:t(()=>{var h;return[V(r((h=l(e).dashboard.user)==null?void 0:h.userName),1)]}),_:1},8,["to"])])])]}),_:1}),s(d,{cols:"12",class:"d-flex justify-end align-center"},{default:t(()=>[o("span",te,r(a.$t("explore.size"))+" : ",1),s(D,{class:"mx-1",density:"compact",icon:"mdi-minus",onClick:j}),s(D,{class:"mx-1",density:"compact",icon:"mdi-plus",onClick:W})]),_:1}),s(d,{cols:"12"},{default:t(()=>[o("div",re,[o("div",{id:"area",ref_key:"area",ref:n,style:S({backgroundColor:l(e).dashboard.backgroundColor})},[(m(!0),w(J,null,G(l(e).dashboard.charts,(i,h)=>(m(),y(Q,{key:i,"container-width":b.value,"container-height":_.value,"index-of-chart":h,"grid-width":b.value/x.x,"grid-height":_.value/x.y,"read-only":!0},null,8,["container-width","container-height","index-of-chart","grid-width","grid-height"]))),128))],4)])]),_:1}),s(d,{cols:"12"},{default:t(()=>[o("p",null,r(a.$t("explore.details")),1)]),_:1}),s(ee),s(d,{cols:"12",class:"d-flex"},{default:t(()=>[o("div",{class:"me-5",style:S(B.value)},[s(C,{class:"me-2",icon:"mdi-thumb-up-outline",onClick:c[0]||(c[0]=i=>R())}),o("span",null,r(l(e).dashboard.like),1)],4),o("div",null,[s(C,{class:"me-2",icon:"mdi-eye-outline"}),o("span",null,r(l(e).dashboard.view),1)])]),_:1}),s(d,{cols:"12"},{default:t(()=>[s(U,null,{default:t(()=>[s(d,{cols:"6"},{default:t(()=>[o("p",null,r(l(e).dashboard.dashboardInfo||"..."),1)]),_:1}),s(d,{cols:"6"},{default:t(()=>{var i;return[o("p",null,r(a.$t("explore.author"))+" : "+r((i=l(e).dashboard.user)==null?void 0:i.userName),1)]}),_:1})]),_:1})]),_:1}),s(d,{cols:"12"},{default:t(()=>[o("p",null,r(a.$t("explore.updatedAt"))+" : "+r(new Date(l(e).dashboard.updatedAt).toLocaleString().split(" ")[0]),1)]),_:1})]),_:1})]),_:1})}}};typeof z=="function"&&z($);const fe=P($,[["__scopeId","data-v-575278f2"]]);export{fe as default};
