import{_ as A,S as I,R as E,a as F,u as L,Z as O,d as P,r as f,$ as T,e as W,o as m,n as x,w as s,g as a,k as r,t,j as d,U as y,f as j,l as H,F as M,a0 as w,p as S,Y}from"./index-DTK9Pl3i.js";import{D as Z}from"./DraggableResizable-DGMyxQV1.js";import{b as V}from"./route-block-B_A1xBdJ.js";import{a as i,V as D}from"./VRow-BdD8RB0G.js";import{V as q}from"./VDivider-BommdNt3.js";import{V as G}from"./VContainer-CtZZ4T-J.js";import"./VHover-dgMB4x6O.js";const J={class:"me-8"},z={__name:"dashboard.[id]",setup(K){const{api:U,apiAuth:$}=Y(),h=I(),_=E(),g=F(),u=L(),e=O();(async()=>{try{await e.getDashboardWithPublicAPI(h.params.id),await U.patch(`/dashboard/view/${h.params.id}`),document.title=e.dashboard.dashboardName+" - DataViz"}catch(o){console.log(o),_.push("/")}})();const C=P(()=>e.dashboard.likeUsers?{color:e.dashboard.likeUsers.includes(u.id)?g.global.current.value.colors.primary:g.global.current.value.colors.onSurface}:{}),N=async()=>{try{if(e.dashboard.likeUsers)if(await $.patch(`/dashboard/like/${h.params.id}`),!e.dashboard.likeUsers.includes(u.id))e.dashboard.likeUsers.push(u.id),e.dashboard.like++;else{const o=e.dashboard.likeUsers.indexOf(u.id);e.dashboard.likeUsers.splice(o,1),e.dashboard.like--}}catch(o){console.log(o),_.push("/login")}},k=f(null),p=f(0),b=f(0),B=new ResizeObserver(o=>{for(const n of o)p.value=n.contentBoxSize[0].inlineSize,b.value=n.contentBoxSize[0].blockSize});T(()=>{B.observe(k.value,{box:"content-box"})});const v={x:96,y:54};return(o,n)=>{const R=W("router-link");return m(),x(G,null,{default:s(()=>[a(D,null,{default:s(()=>[a(i,{cols:"12",class:"d-flex"},{default:s(()=>{var l;return[r("p",J,t(d(e).dashboard.dashboardName),1),r("p",null,[y(t(o.$t("explore.author"))+" : ",1),r("span",null,[a(R,{to:"/author/"+((l=d(e).dashboard.user)==null?void 0:l._id)},{default:s(()=>{var c;return[y(t((c=d(e).dashboard.user)==null?void 0:c.userName),1)]}),_:1},8,["to"])])])]}),_:1}),a(i,{cols:"12"},{default:s(()=>[r("div",{id:"area",ref_key:"area",ref:k,style:w({backgroundColor:d(e).dashboard.backgroundColor})},[(m(!0),j(M,null,H(d(e).dashboard.charts,(l,c)=>(m(),x(Z,{key:l,"container-width":p.value,"container-height":b.value,"index-of-chart":c,"grid-width":p.value/v.x,"grid-height":b.value/v.y,"read-only":!0},null,8,["container-width","container-height","index-of-chart","grid-width","grid-height"]))),128))],4)]),_:1}),a(i,{cols:"12"},{default:s(()=>[r("p",null,t(o.$t("explore.details")),1)]),_:1}),a(q),a(i,{cols:"12",class:"d-flex"},{default:s(()=>[r("div",{class:"me-5",style:w(C.value)},[a(S,{class:"me-2",icon:"mdi-thumb-up-outline",onClick:n[0]||(n[0]=l=>N())}),r("span",null,t(d(e).dashboard.like),1)],4),r("div",null,[a(S,{class:"me-2",icon:"mdi-eye-outline"}),r("span",null,t(d(e).dashboard.view),1)])]),_:1}),a(i,{cols:"12"},{default:s(()=>[a(D,null,{default:s(()=>[a(i,{cols:"6"},{default:s(()=>[r("p",null,t(d(e).dashboard.dashboardInfo||"..."),1)]),_:1}),a(i,{cols:"6"},{default:s(()=>{var l;return[r("p",null,t(o.$t("explore.author"))+" : "+t((l=d(e).dashboard.user)==null?void 0:l.userName),1)]}),_:1})]),_:1})]),_:1}),a(i,{cols:"12"},{default:s(()=>[r("p",null,t(o.$t("explore.updatedAt"))+" : "+t(new Date(d(e).dashboard.updatedAt).toLocaleString().split(" ")[0]),1)]),_:1})]),_:1})]),_:1})}}};typeof V=="function"&&V(z);const de=A(z,[["__scopeId","data-v-91dcd8dc"]]);export{de as default};
