import{_ as j,S as F,R as L,a as O,u as P,Z as T,d as E,r as m,$ as H,e as M,o as g,n as x,w as o,g as s,k as t,t as r,j as l,U as y,V as w,f as Y,l as Z,F as q,a0 as V,p as D,Y as G}from"./index-Dc5jXby0.js";import{D as J}from"./DraggableResizable-D-H3FgJS.js";import{b as S}from"./route-block-B_A1xBdJ.js";import{a as d,V as z}from"./VRow-DWxky1L8.js";import{V as K}from"./VDivider-BDno3ePs.js";import{V as Q}from"./VContainer-DGGo9oaP.js";import"./VHover-DB7_ho0C.js";const X={class:"me-8"},ee={class:"mx-1"},C={__name:"dashboard.[id]",setup(ae){const{api:U,apiAuth:$}=G(),p=F(),_=L(),v=O(),u=P(),e=T();e.clearDashboard(),(async()=>{try{await e.getDashboardWithPublicAPI(p.params.id),await U.patch(`/dashboard/view/${p.params.id}`),document.title=e.dashboard.dashboardName+" - DataViz"}catch(a){console.log(a),_.push("/")}})();const A=E(()=>e.dashboard.likeUsers?{color:e.dashboard.likeUsers.includes(u.id)?v.global.current.value.colors.primary:v.global.current.value.colors.onSurface}:{}),B=async()=>{try{if(e.dashboard.likeUsers)if(await $.patch(`/dashboard/like/${p.params.id}`),!e.dashboard.likeUsers.includes(u.id))e.dashboard.likeUsers.push(u.id),e.dashboard.like++;else{const a=e.dashboard.likeUsers.indexOf(u.id);e.dashboard.likeUsers.splice(a,1),e.dashboard.like--}}catch(a){console.log(a),_.push("/login")}},n=m(null),b=m(0),f=m(0),N=new ResizeObserver(a=>{for(const c of a)b.value=c.contentBoxSize[0].inlineSize,f.value=c.contentBoxSize[0].blockSize}),R=()=>{const a=n.value.offsetWidth+200;a>2560||(n.value.style.width=a+"px")},I=()=>{const a=n.value.offsetWidth-200;a<200||(n.value.style.width=a+"px")};H(()=>{N.observe(n.value,{box:"content-box"})});const k={x:96,y:54};return(a,c)=>{const W=M("router-link");return g(),x(Q,null,{default:o(()=>[s(z,null,{default:o(()=>[s(d,{cols:"12",class:"d-flex"},{default:o(()=>{var i;return[t("p",X,r(l(e).dashboard.dashboardName),1),t("p",null,[y(r(a.$t("explore.author"))+" : ",1),t("span",null,[s(W,{to:"/author/"+((i=l(e).dashboard.user)==null?void 0:i._id)},{default:o(()=>{var h;return[y(r((h=l(e).dashboard.user)==null?void 0:h.userName),1)]}),_:1},8,["to"])])])]}),_:1}),s(d,{cols:"12",class:"d-flex justify-end align-center"},{default:o(()=>[t("span",ee,r(a.$t("explore.size"))+" : ",1),s(w,{class:"mx-1",density:"compact",icon:"mdi-minus",onClick:I}),s(w,{class:"mx-1",density:"compact",icon:"mdi-plus",onClick:R})]),_:1}),s(d,{cols:"12"},{default:o(()=>[t("div",{id:"area",ref_key:"area",ref:n,style:V({backgroundColor:l(e).dashboard.backgroundColor})},[(g(!0),Y(q,null,Z(l(e).dashboard.charts,(i,h)=>(g(),x(J,{key:i,"container-width":b.value,"container-height":f.value,"index-of-chart":h,"grid-width":b.value/k.x,"grid-height":f.value/k.y,"read-only":!0},null,8,["container-width","container-height","index-of-chart","grid-width","grid-height"]))),128))],4)]),_:1}),s(d,{cols:"12"},{default:o(()=>[t("p",null,r(a.$t("explore.details")),1)]),_:1}),s(K),s(d,{cols:"12",class:"d-flex"},{default:o(()=>[t("div",{class:"me-5",style:V(A.value)},[s(D,{class:"me-2",icon:"mdi-thumb-up-outline",onClick:c[0]||(c[0]=i=>B())}),t("span",null,r(l(e).dashboard.like),1)],4),t("div",null,[s(D,{class:"me-2",icon:"mdi-eye-outline"}),t("span",null,r(l(e).dashboard.view),1)])]),_:1}),s(d,{cols:"12"},{default:o(()=>[s(z,null,{default:o(()=>[s(d,{cols:"6"},{default:o(()=>[t("p",null,r(l(e).dashboard.dashboardInfo||"..."),1)]),_:1}),s(d,{cols:"6"},{default:o(()=>{var i;return[t("p",null,r(a.$t("explore.author"))+" : "+r((i=l(e).dashboard.user)==null?void 0:i.userName),1)]}),_:1})]),_:1})]),_:1}),s(d,{cols:"12"},{default:o(()=>[t("p",null,r(a.$t("explore.updatedAt"))+" : "+r(new Date(l(e).dashboard.updatedAt).toLocaleString().split(" ")[0]),1)]),_:1})]),_:1})]),_:1})}}};typeof S=="function"&&S(C);const ce=j(C,[["__scopeId","data-v-877fb220"]]);export{ce as default};
