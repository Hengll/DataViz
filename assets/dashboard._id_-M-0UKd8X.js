import{_ as A,S as I,R as F,a as L,u as O,Z as P,d as T,r as f,$ as W,e as j,o as m,n as x,w as s,g as a,k as r,t,j as d,U as y,f as E,l as H,F as M,a0 as w,p as D,Y}from"./index-DgiCD0nG.js";import{D as Z}from"./DraggableResizable-Cgid9jtT.js";import{b as S}from"./route-block-B_A1xBdJ.js";import{a as i,V}from"./VRow-BTitbmQ4.js";import{V as q}from"./VDivider-C2HJDsnd.js";import{V as G}from"./VContainer-qKgdq2MU.js";import"./VHover-C8pYTkLt.js";const J={class:"me-8"},z={__name:"dashboard.[id]",setup(K){const{api:U,apiAuth:$}=Y(),h=I(),_=F(),g=L(),u=O(),e=P();e.clearDashboard(),(async()=>{try{await e.getDashboardWithPublicAPI(h.params.id),await U.patch(`/dashboard/view/${h.params.id}`),document.title=e.dashboard.dashboardName+" - DataViz"}catch(o){console.log(o),_.push("/")}})();const C=T(()=>e.dashboard.likeUsers?{color:e.dashboard.likeUsers.includes(u.id)?g.global.current.value.colors.primary:g.global.current.value.colors.onSurface}:{}),N=async()=>{try{if(e.dashboard.likeUsers)if(await $.patch(`/dashboard/like/${h.params.id}`),!e.dashboard.likeUsers.includes(u.id))e.dashboard.likeUsers.push(u.id),e.dashboard.like++;else{const o=e.dashboard.likeUsers.indexOf(u.id);e.dashboard.likeUsers.splice(o,1),e.dashboard.like--}}catch(o){console.log(o),_.push("/login")}},k=f(null),b=f(0),p=f(0),B=new ResizeObserver(o=>{for(const n of o)b.value=n.contentBoxSize[0].inlineSize,p.value=n.contentBoxSize[0].blockSize});W(()=>{B.observe(k.value,{box:"content-box"})});const v={x:96,y:54};return(o,n)=>{const R=j("router-link");return m(),x(G,null,{default:s(()=>[a(V,null,{default:s(()=>[a(i,{cols:"12",class:"d-flex"},{default:s(()=>{var l;return[r("p",J,t(d(e).dashboard.dashboardName),1),r("p",null,[y(t(o.$t("explore.author"))+" : ",1),r("span",null,[a(R,{to:"/author/"+((l=d(e).dashboard.user)==null?void 0:l._id)},{default:s(()=>{var c;return[y(t((c=d(e).dashboard.user)==null?void 0:c.userName),1)]}),_:1},8,["to"])])])]}),_:1}),a(i,{cols:"12"},{default:s(()=>[r("div",{id:"area",ref_key:"area",ref:k,style:w({backgroundColor:d(e).dashboard.backgroundColor})},[(m(!0),E(M,null,H(d(e).dashboard.charts,(l,c)=>(m(),x(Z,{key:l,"container-width":b.value,"container-height":p.value,"index-of-chart":c,"grid-width":b.value/v.x,"grid-height":p.value/v.y,"read-only":!0},null,8,["container-width","container-height","index-of-chart","grid-width","grid-height"]))),128))],4)]),_:1}),a(i,{cols:"12"},{default:s(()=>[r("p",null,t(o.$t("explore.details")),1)]),_:1}),a(q),a(i,{cols:"12",class:"d-flex"},{default:s(()=>[r("div",{class:"me-5",style:w(C.value)},[a(D,{class:"me-2",icon:"mdi-thumb-up-outline",onClick:n[0]||(n[0]=l=>N())}),r("span",null,t(d(e).dashboard.like),1)],4),r("div",null,[a(D,{class:"me-2",icon:"mdi-eye-outline"}),r("span",null,t(d(e).dashboard.view),1)])]),_:1}),a(i,{cols:"12"},{default:s(()=>[a(V,null,{default:s(()=>[a(i,{cols:"6"},{default:s(()=>[r("p",null,t(d(e).dashboard.dashboardInfo||"..."),1)]),_:1}),a(i,{cols:"6"},{default:s(()=>{var l;return[r("p",null,t(o.$t("explore.author"))+" : "+t((l=d(e).dashboard.user)==null?void 0:l.userName),1)]}),_:1})]),_:1})]),_:1}),a(i,{cols:"12"},{default:s(()=>[r("p",null,t(o.$t("explore.updatedAt"))+" : "+t(new Date(d(e).dashboard.updatedAt).toLocaleString().split(" ")[0]),1)]),_:1})]),_:1})]),_:1})}}};typeof S=="function"&&S(z);const de=A(z,[["__scopeId","data-v-6ff6101f"]]);export{de as default};
