import{_ as M,b as H,T as W,R as X,r as i,a7 as Y,$ as q,o as l,f as g,g as a,w as t,k as u,t as c,V as f,U as p,ak as z,W as v,p as T,F as k,l as x,aj as G,al as J,am as Q,an as Z,ao as ee,n as d,X as ae,Y as te}from"./index-DgiCD0nG.js";import{V as L,D as I}from"./DashboardCard-DpxtyrF8.js";import{b as N}from"./route-block-B_A1xBdJ.js";import{V as P,a as m}from"./VRow-BTitbmQ4.js";import{V as S}from"./VDivider-C2HJDsnd.js";import{V as oe}from"./VMenu-0v_Y2jvd.js";import{V as se,a as le}from"./VList-GDRvtvQm.js";import{V as re}from"./VContainer-qKgdq2MU.js";import{V as j}from"./VHover-C8pYTkLt.js";import"./ssrBoot-BMhA3bp9.js";const ne={class:"me-5",style:{width:"80px"}},de={style:{width:"100px"}},R={__name:"index",setup(ie){const{apiAuth:h}=te(),{t:b}=H(),w=W(),U=X(),$=i(!0),D=i(0),F=i(["updatedAt_-1","updatedAt_1","createdAt_-1","createdAt_1"]),y=i("updatedAt_-1"),_=i([]);Y(y,()=>{const o=y.value.split("_");_.value.sort((s,e)=>(new Date(s[o[0]]).getTime()-new Date(e[o[0]]).getTime())*o[1])});const n=i({isOpen:!1,id:""}),A=o=>{n.value.id=o,n.value.isOpen=!0},B=()=>{n.value.id="",n.value.isOpen=!1},E=async()=>{try{const{data:o}=await h.get("/dashboard");_.value=o.result}catch(o){console.log(o)}};E();const O=async o=>{var s,e;try{await h.delete(`/dashboard/${o}`),E(),w({text:b("dashboard.deleteSuccess"),snackbarProps:{color:"green"}}),B()}catch(r){console.log(r),w({text:b("dashboard."+((e=(s=r==null?void 0:r.response)==null?void 0:s.data)==null?void 0:e.message)||"unknownError"),snackbarProps:{color:"red"}})}},K=async()=>{var o,s;try{const{data:e}=await h.post("/dashboard");U.push(`/editor/data/${e.result._id}`)}catch(e){console.log(e),w({text:b("dashboard."+((s=(o=e==null?void 0:e.response)==null?void 0:o.data)==null?void 0:s.message)||"unknownError"),snackbarProps:{color:"red"}})}};return q(()=>{$.value=!1}),(o,s)=>(l(),g(k,null,[a(re,{fluid:""},{default:t(()=>[a(P,null,{default:t(()=>[a(m,{cols:"12"},{default:t(()=>[u("h1",null,c(o.$t("auth.myDashboards")),1)]),_:1}),a(S),a(m,{cols:"6"},{default:t(()=>[a(f,{"prepend-icon":"mdi-plus",variant:"elevated",color:"primary",onClick:K},{default:t(()=>[p(c(o.$t("dashboard.new")),1)]),_:1})]),_:1}),a(m,{cols:6,class:"d-flex align-center justify-end"},{default:t(()=>[u("div",ne,[a(z,{modelValue:D.value,"onUpdate:modelValue":s[0]||(s[0]=e=>D.value=e),density:"compact",divided:"",class:"w-100"},{default:t(()=>[a(f,{value:0,variant:"outlined",color:"primary",class:"w-50",icon:"mdi-view-grid"}),a(f,{value:1,variant:"outlined",color:"primary",class:"w-50",icon:"mdi-menu"})]),_:1},8,["modelValue"])]),u("div",de,[a(oe,null,{activator:t(({props:e})=>[a(f,v({variant:"outlined",color:"primary"},e),{append:t(()=>[a(T,{icon:e["aria-expanded"]==="true"?"mdi-chevron-up":"mdi-chevron-down"},null,8,["icon"])]),default:t(()=>[s[4]||(s[4]=p("sort "))]),_:2},1040)]),default:t(()=>[a(se,null,{default:t(()=>[(l(!0),g(k,null,x(F.value,(e,r)=>(l(),d(le,{key:r,class:"d-flex align-center",onClick:V=>y.value=e},{default:t(()=>[u("span",null,c(o.$t("dashboard."+e)),1),e===y.value?(l(),d(T,{key:0,icon:"mdi-check "})):ae("",!0)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})])]),_:1}),a(m,{cols:"12"},{default:t(()=>[a(P,null,{default:t(()=>[D.value===0?(l(!0),g(k,{key:0},x(_.value,e=>(l(),d(m,{key:e._id,class:"v-col-12 v-col-sm-6 v-col-md-4 v-col-lg-3"},{default:t(()=>[a(j,null,{default:t(({isHovering:r,props:V})=>[u("div",v({ref_for:!0},V,{class:"bg-secondary rounded"}),[$.value?(l(),d(L,{key:0,type:"image, article"})):(l(),d(I,v({key:1,ref_for:!0},e,{"read-only":!1,class:{"dashboard-hover":!!r},style:{transition:"0.2s"},onEdit:C=>o.$router.push(`/editor/dashboard/${e._id}`),onDelete:C=>A(e._id)}),null,16,["class","onEdit","onDelete"]))],16)]),_:2},1024)]),_:2},1024))),128)):(l(!0),g(k,{key:1},x(_.value,e=>(l(),d(m,{key:e._id,cols:"12"},{default:t(()=>[a(j,null,{default:t(({isHovering:r,props:V})=>[u("div",v({ref_for:!0},V,{class:"bg-secondary rounded"}),[$.value?(l(),d(L,{key:0,type:"image, article"})):(l(),d(I,v({key:1,ref_for:!0},e,{"read-only":!1,"card-form":!1,class:{"dashboard-hover":!!r},style:{transition:"0.2s"},onEdit:C=>o.$router.push(`/editor/dashboard/${e._id}`),onDelete:C=>A(e._id)}),null,16,["class","onEdit","onDelete"]))],16)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1}),a(ee,{modelValue:n.value.isOpen,"onUpdate:modelValue":s[2]||(s[2]=e=>n.value.isOpen=e),class:"w-250",onKeydownOnce:s[3]||(s[3]=Z(e=>O(n.value.id),["enter"]))},{default:t(()=>[a(G,null,{default:t(()=>[a(J,{class:"text-center pa-10"},{default:t(()=>[p(c(o.$t("dashboard.deleteConfirm")),1)]),_:1}),a(S),a(Q,{class:"d-flex justify-center"},{default:t(()=>[a(f,{color:"primary",variant:"flat",onClick:s[1]||(s[1]=e=>O(n.value.id))},{default:t(()=>[p(c(o.$t("dashboard.confirm")),1)]),_:1}),a(f,{variant:"text",onClick:B},{default:t(()=>[p(c(o.$t("dashboard.cancel")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};typeof N=="function"&&N(R);const ke=M(R,[["__scopeId","data-v-28aec9a5"]]);export{ke as default};
